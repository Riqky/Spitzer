from Spitzer.config.config import get_data
from Spitzer.command import run
from Spitzer.result import result

def exploit(url, nmap):
    print('[*] Checking headers')
    file = get_data('securityheaders')
    
    try:
        output = run(['python3',file,url], capture_output=True)
    except:
        raise
    
    if 'FAIL' in output or 'WARN' in output:
        result.add(url, 'security headers', output)
        print(output)
    else:
        print('[*] No warnings or errors found')