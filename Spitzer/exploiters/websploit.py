import json

from Spitzer.exploiters.web import *
from Spitzer.config import config

def exploit(host, nmap, port):
    
    url = 'https://' if port == 443 else 'http://' #TODO make sure this works for all ports
    url += host + ':' + str(port)
    print(nmap)
    modules = config.get_data('web')
    for module in modules:
        eval(module + '.exploit(\''+url+'\', ' + json.dumps(nmap) + ')')

    