import command
from scanner import nmapper

def exploit(host):
    __smb(host)
    __nfs(host)

def __smb(host):
    smbResult = command.run(['smbmap', '-H ' + host], capture_output=True).stdout

    if 'STATUS_ACCESS_DENIED' in smbResult:
        smbResult = command.run(['smbmap', '-u anonymous', '-H ' + host], capture_output=True).stdout

    if not 'STATUS_ACCESS_DENIED' in smbResult and not 'STATUS_LOGON_FAILURE' in smbResult:
        print(smbResult + '\n')
    else:
        print('Failed for ' + host + '\n')
        
        
def __nfs(host):
    result = nmapper.scanSpecific(host, 111, '--script="nfs-showmount"') #TODO solve
