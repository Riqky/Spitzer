import subprocess

def smb(hosts):
    for host in hosts:
        smbResult = __empty(host)

        if 'STATUS_ACCESS_DENIED' in smbResult:
            smbResult = __anonymous(host)

        if not 'STATUS_ACCESS_DENIED' in smbResult and not 'STATUS_LOGON_FAILURE' in smbResult:
            print(smbResult + '\n')
        else:
            print('Failed for ' + host + '\n')
        
def __empty(host):
    return subprocess.run(['smbmap', '-H ' + host], capture_output=True).stdout.decode('utf-8')

def __anonymous(host):
    return subprocess.run(['smbmap', '-u anonymous', '-H ' + host], capture_output=True).stdout.decode('utf-8')
        
def nfs(hosts):
    for host in hosts:
        i=0
        #TODO this can be don with showmount (apt install nfs-common) or a nmap script
        #TODO find how to get script output in python-nmap
        
