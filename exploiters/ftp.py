from scanner import nmapper
import command
import searchsploit
import json

result = {}

def exploit(host, nmap):
    global result

    result = nmap

    __version(host)
    __anonymous(host)
    

def __version(host):
    
    product = result[host]['tcp']['21']['product']
    version = result[host]['tcp']['21']['version']

    searchsploit.find(product, version)

def __anonymous(host):
    global result
    if 'Anonymous FTP login allowed' in result[host]['tcp']['21']['script']['ftp-anon']:
        print('ftp anonymous login is allowed') 